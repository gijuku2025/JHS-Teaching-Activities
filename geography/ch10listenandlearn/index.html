<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Ch 10 Listen and Learn</title>

<style>
  body {
    font-family: Arial, sans-serif;
    background-color: #f5f7fa;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    margin: 0;
  }

  .container {
    background: #fff;
    padding: 30px;
    border-radius: 16px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    text-align: center;
    width: 380px;
  }

  h1 {
    font-size: 20px;
    margin-bottom: 12px;
    color: #333;
  }

  #gameTitle {
    font-size: 24px;
    color: #333;
    margin-bottom: 12px;
  }

  input[type="text"] {
    padding: 10px;
    width: 80%;
    border: 1px solid #ccc;
    border-radius: 8px;
    margin-bottom: 20px;
  }

  button {
    padding: 12px;
    margin: 8px 0;
    width: 100%;
    border: none;
    border-radius: 8px;
    font-size: 16px;
    cursor: pointer;
    transition: background 0.2s;
  }

  .primary {
    background-color: #4CAF50;
    color: white;
  }

  .primary:hover {
    background-color: #45a049;
  }

  .play-btn {
    background-color: #1E90FF;
    color: white;
  }

  .play-btn:hover {
    background-color: #1C86EE;
  }

  .choice-btn {
    margin: 5px 0;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    transition: transform 0.2s, box-shadow 0.2s, opacity 0.2s;
  }

  .choice-btn:hover {
    opacity: 0.9;
  }

  .choice-btn.correct {
    animation: pulse 0.5s ease;
  }

  @keyframes pulse {
    0%   { transform: scale(1);   box-shadow: 0 0 0px #4CAF50; }
    50%  { transform: scale(1.1); box-shadow: 0 0 12px #4CAF50; }
    100% { transform: scale(1);   box-shadow: 0 0 0px #4CAF50; }
  }

  .feedback {
    margin-top: 15px;
    font-weight: bold;
    font-size: 18px;
  }

  .hidden {
    display: none;
  }

  .progress-bar {
    width: 100%;
    height: 8px;
    background-color: #e0e0e0;
    border-radius: 4px;
    margin-bottom: 12px;
  }

  #progressFill {
    height: 100%;
    width: 0%;
    background-color: #FFA500;
    border-radius: 4px;
    transition: width 0.3s ease, background-color 0.3s ease;
  }

  #questionCounter {
    margin-bottom: 8px;
    font-weight: bold;
    color: #555;
    font-size: 16px;
  }
</style>
</head>

<body>

<div class="container" id="startScreen">
  <h1>Enter nickname</h1>
  <input type="text" id="nickname" placeholder="Your name">
  <button class="primary" onclick="startQuiz()">Start</button>
</div>

<div class="container hidden" id="quizScreen">
  <h1 id="gameTitle"></h1>
  <div class="progress-bar"><div id="progressFill"></div></div>
  <div id="questionCounter"></div>
  <h1>Listen and choose:</h1>
  <button class="play-btn" onclick="playSentence()">ðŸ”Š Play Sentence</button>
  <div id="choices"></div>
  <div class="feedback" id="feedback"></div>
</div>

<div class="container hidden" id="endScreen">
  <h1>Quiz Finished!</h1>
  <p id="finalResult"></p>
  <button class="primary" onclick="location.reload()">Play Again</button>
</div>

<script>
const quizTitle = "Ch 10 Listen and Learn";

const sentences = [
  {
    en: "Climates in the Temperate Zone have four seasons: Spring, Summer, Autumn, Winter.",
    jp: "æ¸©å¸¯æ°—å€™ã«ã¯æ˜¥ã€å¤ã€ç§‹ã€å†¬ã®å››å­£ãŒã‚ã‚Šã¾ã™ã€‚",
    enAudio: "audio/01_climates_in_the_temperate_zone_en.mp3",
    jpAudio: "audio/01_climates_in_the_temperate_zone_jp.mp3"
  },
  {
    en: 'Mild means "Not too much, not too little. Not too hot, not too cold."',
    jp: "ç©ã‚„ã‹ã¨ã¯ã€Œå¤šã™ãŽãšã€å°‘ãªã™ãŽãšã€‚æš‘ã™ãŽãšã€å¯’ã™ãŽãšã€ã¨ã„ã†æ„å‘³ã§ã™ã€‚",
    enAudio: "audio/02_mild_means_not_too_much_not_to_en.mp3",
    jpAudio: "audio/02_mild_means_not_too_much_not_to_jp.mp3"
  },
  {
    en: "Do you remember what climate is? Climate is Polar, Tropical, Temperate, and Arid.",
    jp: "æ°—å€™ã«ã¤ã„ã¦è¦šãˆã¦ã„ã¾ã™ã‹ï¼Ÿæ°—å€™ã«ã¯å¯’å¸¯ã€ç†±å¸¯ã€æ¸©å¸¯ã€ä¹¾ç‡¥å¸¯ãŒã‚ã‚Šã¾ã™ã€‚",
    enAudio: "audio/03_do_you_remember_what_climate_i_en.mp3",
    jpAudio: "audio/03_do_you_remember_what_climate_i_jp.mp3"
  },
  {
    en: "Temperature and rainfall are mostly mild.",
    jp: "æ°—æ¸©ã¨é™æ°´é‡ã¯ä¸»ã«ç©ã‚„ã‹ã§ã™ã€‚",
    enAudio: "audio/04_temperature_and_rainfall_are_m_en.mp3",
    jpAudio: "audio/04_temperature_and_rainfall_are_m_jp.mp3"
  },
  {
    en: "Some Temperate Climates have very hot summers.",
    jp: "ã‚ã‚‹æ¸©å¸¯æ°—å€™ã§ã¯å¤ãŒéžå¸¸ã«æš‘ããªã‚Šã¾ã™ã€‚",
    enAudio: "audio/05_some_temperate_climates_have_v_en.mp3",
    jpAudio: "audio/05_some_temperate_climates_have_v_jp.mp3"
  },
  {
    en: "Some Temperate Climates have very cold winters.",
    jp: "ã‚ã‚‹æ¸©å¸¯æ°—å€™ã§ã¯å†¬ãŒéžå¸¸ã«å¯’ããªã‚Šã¾ã™ã€‚",
    enAudio: "audio/06_some_temperate_climates_have_v_en.mp3",
    jpAudio: "audio/06_some_temperate_climates_have_v_jp.mp3"
  },
  {
    en: "Some Temperate Climates have very dry summers.",
    jp: "ã‚ã‚‹æ¸©å¸¯æ°—å€™ã§ã¯å¤ãŒéžå¸¸ã«ä¹¾ç‡¥ã—ã¾ã™ã€‚",
    enAudio: "audio/07_some_temperate_climates_have_v_en.mp3",
    jpAudio: "audio/07_some_temperate_climates_have_v_jp.mp3"
  },
  {
    en: "Some Temperate Climates have very dry winters.",
    jp: "ã‚ã‚‹æ¸©å¸¯æ°—å€™ã§ã¯å†¬ãŒéžå¸¸ã«ä¹¾ç‡¥ã—ã¾ã™ã€‚",
    enAudio: "audio/08_some_temperate_climates_have_v_en.mp3",
    jpAudio: "audio/08_some_temperate_climates_have_v_jp.mp3"
  },
  {
    en: "Oceanic Climates have mild summers and mild winters.",
    jp: "æµ·æ´‹æ€§æ°—å€™ã¯ã€å¤ã‚‚å†¬ã‚‚ç©ã‚„ã‹ã§ã™ã€‚",
    enAudio: "audio/09_oceanic_climates_have_mild_sum_en.mp3",
    jpAudio: "audio/09_oceanic_climates_have_mild_sum_jp.mp3"
  },
  {
    en: "Mediterranean Climates are dry in summer with mild rainfall in winter. Summers are hot and winters are mild.",
    jp: "åœ°ä¸­æµ·æ€§æ°—å€™ã¯ã€å¤ã¯ä¹¾ç‡¥ã—ã¦ã„ã¦å†¬ã¯ç©ã‚„ã‹ãªé›¨ãŒã‚ã‚Šã¾ã™ã€‚å¤ã¯æš‘ãã€å†¬ã¯ç©ã‚„ã‹ã§ã™ã€‚",
    enAudio: "audio/10_mediterranean_climates_are_dry_en.mp3",
    jpAudio: "audio/10_mediterranean_climates_are_dry_jp.mp3"
  },
  {
    en: "New Zealand has an Oceanic Climate. Wellington is the capital city of New Zealand.",
    jp: "ãƒ‹ãƒ¥ãƒ¼ã‚¸ãƒ¼ãƒ©ãƒ³ãƒ‰ã¯æµ·æ´‹æ€§æ°—å€™ã§ã™ã€‚ã‚¦ã‚§ãƒªãƒ³ãƒˆãƒ³ã¯ãƒ‹ãƒ¥ãƒ¼ã‚¸ãƒ¼ãƒ©ãƒ³ãƒ‰ã®é¦–éƒ½ã§ã™ã€‚",
    enAudio: "audio/11_new_zealand_has_an_oceanic_cli_en.mp3",
    jpAudio: "audio/11_new_zealand_has_an_oceanic_cli_jp.mp3"
  },
  {
    en: "Wellington is in the Temperate Zone. It has an Oceanic Climate. There is mild rain all year. Summer and winter are both mild.",
    jp: "ã‚¦ã‚§ãƒªãƒ³ãƒˆãƒ³ã¯æ¸©å¸¯æ°—å€™ã«å±žã—ã¦ã„ã¾ã™ã€‚ãã®æ°—å€™ã¯æµ·æ´‹æ€§æ°—å€™ã§ã€ä¸€å¹´ä¸­é›¨ãŒç©ã‚„ã‹ã«é™ã‚Šã¾ã™ã€‚å¤ã‚‚å†¬ã‚‚ç©ã‚„ã‹ã§ã™ã€‚",
    enAudio: "audio/12_wellington_is_in_the_temperate_en.mp3",
    jpAudio: "audio/12_wellington_is_in_the_temperate_jp.mp3"
  },
  {
    en: "Italy has a Mediterranean Climate. Rome is the capital city of Italy.",
    jp: "ã‚¤ã‚¿ãƒªã‚¢ã¯åœ°ä¸­æµ·æ€§æ°—å€™ã§ã™ã€‚ãƒ­ãƒ¼ãƒžã¯ã‚¤ã‚¿ãƒªã‚¢ã®é¦–éƒ½ã§ã™ã€‚",
    enAudio: "audio/13_italy_has_a_mediterranean_clim_en.mp3",
    jpAudio: "audio/13_italy_has_a_mediterranean_clim_jp.mp3"
  },
  {
    en: "Traditional Italian families spent a long time eating lunch together.",
    jp: "ä¼çµ±çš„ãªã‚¤ã‚¿ãƒªã‚¢ã®å®¶æ—ã¯ã€é•·ã„æ™‚é–“ã‚’éŽã”ã—ãªãŒã‚‰æ˜¼é£Ÿã‚’ä¸€ç·’ã«é£Ÿã¹ã¾ã™ã€‚",
    enAudio: "audio/14_traditional_italian_families_s_en.mp3",
    jpAudio: "audio/14_traditional_italian_families_s_jp.mp3"
  },
  {
    en: "August 15 is an Italian national holiday called Ferragosto.",
    jp: "8æœˆ15æ—¥ã¯ãƒ•ã‚§ãƒ©ã‚´ã‚¹ãƒˆã¨å‘¼ã°ã‚Œã‚‹ã‚¤ã‚¿ãƒªã‚¢ã®å›½æ°‘ã®ç¥æ—¥ã§ã™ã€‚",
    enAudio: "audio/15_august_15_is_an_italian_nation_en.mp3",
    jpAudio: "audio/15_august_15_is_an_italian_nation_jp.mp3"
  }
];

let questions = [];
let nickname = "";
let currentQuestion = 0;
let score = 0;
let firstTry = true;
let startTime;

const startScreen = document.getElementById("startScreen");
const quizScreen = document.getElementById("quizScreen");
const endScreen = document.getElementById("endScreen");
const gameTitle = document.getElementById("gameTitle");
const choicesDiv = document.getElementById("choices");
const feedbackDiv = document.getElementById("feedback");
const finalResult = document.getElementById("finalResult");
const questionCounterDiv = document.getElementById("questionCounter");
const progressFill = document.getElementById("progressFill");

function shuffle(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
}

function startQuiz() {
  nickname = document.getElementById("nickname").value.trim() || "Player";
  startTime = new Date();
  gameTitle.textContent = quizTitle;

  questions = [...sentences];
  shuffle(questions);
  questions = questions.slice(0, 10);

  startScreen.classList.add("hidden");
  quizScreen.classList.remove("hidden");

  currentQuestion = 0;
  score = 0;
  showQuestion();
}

function showQuestion() {
  feedbackDiv.textContent = "";
  feedbackDiv.style.color = "#333";
  firstTry = true;
  choicesDiv.innerHTML = "";

  const q = questions[currentQuestion];

  quizScreen.dataset.answer = q.jp;
  quizScreen.dataset.audio = q.enAudio;

  questionCounterDiv.textContent =
    `Question ${currentQuestion + 1} of ${questions.length}`;

  const progress = (currentQuestion + 1) / questions.length;
  progressFill.style.width = (progress * 100) + "%";
  progressFill.style.backgroundColor =
    progress < 0.5 ? "#FFA500" :
    progress < 1   ? "#FFD700" :
                     "#4CAF50";

  let pool = sentences.map(s => s.jp);
  shuffle(pool);

  let options = pool.slice(0, 3);
  if (!options.includes(q.jp)) {
    options[Math.floor(Math.random() * 3)] = q.jp;
  }

  const colors = ["#FFA500", "#FF4C4C", "#4CAF50"];

  options.forEach((opt, index) => {
    const btn = document.createElement("button");
    btn.textContent = opt;
    btn.className = "choice-btn";
    btn.style.backgroundColor = colors[index];
    btn.style.color = "#fff";
    btn.style.fontSize = "18px";
    btn.style.padding = "14px";
    btn.onclick = () => checkAnswer(opt, btn);
    choicesDiv.appendChild(btn);
  });
}

function playSentence() {
  const audio = new Audio(quizScreen.dataset.audio);
  audio.play();
}

function checkAnswer(choice, btn) {
  const correct = quizScreen.dataset.answer;
  disableChoices();

  if (choice === correct) {
    feedbackDiv.textContent = "Correct!";
    btn.classList.add("correct");
    score += firstTry ? 2 : 1;
  } else {
    if (firstTry) {
      feedbackDiv.style.color = "orange";
      feedbackDiv.textContent = "Try again!";
      firstTry = false;
      enableChoices();
      return;
    } else {
      feedbackDiv.style.color = "red";
      feedbackDiv.textContent = `Wrong! Correct answer: ${correct}`;
    }
  }

  if (currentQuestion === questions.length - 1) {
    setTimeout(endQuiz, 1000);
  } else {
    const nextBtn = document.createElement("button");
    nextBtn.textContent = "Next Question â†’";
    nextBtn.style.backgroundColor = "#800080";
    nextBtn.style.color = "#fff";
    nextBtn.style.fontSize = "16px";
    nextBtn.style.padding = "12px";
    nextBtn.style.marginTop = "10px";
    nextBtn.style.borderRadius = "8px";
    nextBtn.onclick = nextQuestion;
    choicesDiv.appendChild(nextBtn);
  }
}

function disableChoices() {
  choicesDiv.querySelectorAll(".choice-btn").forEach(btn => btn.disabled = true);
}

function enableChoices() {
  choicesDiv.querySelectorAll(".choice-btn").forEach(btn => btn.disabled = false);
}

function nextQuestion() {
  currentQuestion++;
  showQuestion();
}

function endQuiz() {
  quizScreen.classList.add("hidden");
  endScreen.classList.remove("hidden");

  const endTime = new Date();
  const seconds = Math.floor((endTime - startTime) / 1000);
  const minutes = Math.floor(seconds / 60);

  finalResult.innerHTML = `
    <strong>${nickname}</strong><br>
    Score: ${score} / ${questions.length * 2}<br>
    Started: ${startTime.toLocaleString()}<br>
    Time: ${minutes} min ${seconds % 60} sec
  `;
}
</script>

</body>
</html>
